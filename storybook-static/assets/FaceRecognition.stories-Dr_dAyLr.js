import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{r as s}from"./index-DmM0KDA7.js";import{W as T,a as A,A as B}from"./useAxios-Cfhxm_Qp.js";import{D as L}from"./global-BfAsUHpc.js";const m=()=>{const[n,u]=s.useState(null),[x,R]=s.useState(null),f=s.useRef(null),[k,a]=s.useState(!1),[h,p]=s.useState(),[I,D]=s.useState(0),[g,b]=s.useState(null),[E,r]=s.useState(!1),P=async()=>{var o,y;a(!0),r(!0);try{if(x){a(!0);const l=x,t=new FormData;t.append("image",l);const d=await A.post("/persons/authenticate",t,{headers:{"x-api-key":"ykru2gKctIAmpLETxx0buQ","x-group-id":"d2ea1214-22fd-4512-9844-577bdab9ccd5"}});a(!1),console.log(d),p(d.data.potential_match),D(d.data.similarity_score),r(!0)}}catch(l){a(!1);const t=l;B&&b((y=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:y.detail),r(!0)}},j=s.useCallback(()=>{var o;u(null),p(void 0),a(!1),b(null),(o=f.current)==null||o.close_camera()},[]);return e.jsxs("main",{className:"flex w-full flex-col bg-gray-100 p-8 relative",children:[e.jsx("h1",{className:"font-bold text-4xl",children:"Face Search"}),e.jsxs("ul",{className:"mt-3 list-inside list-disc text-gray-500",children:[e.jsxs("li",{children:[" ","Click on the ",e.jsx("strong",{children:"Capture Face"})," button to open the camera module."]}),e.jsx("li",{children:" Please make sure you allow the browser to access your camera."}),e.jsxs("li",{children:[" ","Take a picture of your face and click the ",e.jsx("strong",{children:"Verify"})," ","button to find a user that matches your face."]})]}),e.jsx("div",{className:"w-fit mx-auto mt-6",children:e.jsx(T,{setImageFile:R,setImageSrc:u,imageSrc:n,ref:f})}),n&&e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"mt-5 py-3 text-white bg-[#4327B2] border-[#4327B2] border-[1px] px-5 rounded-md cursor-pointer",onClick:P,children:"Verify Photo"})}),E&&e.jsxs(L,{closeDialog:()=>{r(!1),j()},children:[e.jsx("div",{className:"flex justify-center",children:n&&e.jsx("div",{className:"relative h-fit w-2/3 rounded-md bg-white shadow-md mb-3",children:e.jsx("img",{src:n,alt:"Selected Image",style:{objectFit:"scale-down"},className:"rounded-md"})})}),k&&e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"border-t-[#4327B2] h-16 w-16 animate-spin rounded-full border-4 border-t-4 border-gray-200"}),e.jsx("h4",{className:"mt-3 text-xl font-bold",children:"Verifying Image"})]}),h&&e.jsxs("div",{className:"mt-5 text-center",children:[e.jsx("h4",{className:"mb-2",children:"We have your result!"}),e.jsxs("p",{children:["Based on our records, there's a",e.jsxs("strong",{children:[" ",(I*100).toFixed(2),"% "]})," ","probability that you're",e.jsxs("strong",{children:[" ",h._source.person_name]})]}),e.jsx("button",{onClick:()=>{j(),r(!1)},className:"mt-5",children:"Compare Again"})]}),g!==null&&e.jsx("div",{className:"flex flex-col items-center justify-center",children:e.jsx("h4",{className:"mt-3 text-xl font-bold",children:g})})]})]})};m.__docgenInfo={description:"",methods:[],displayName:"FaceRecognition"};const K={title:"ReactComponentLibrary/faceRecognition",component:m},C=()=>e.jsx(m,{}),c=C.bind({});c.args={title:"Default theme",theme:"primary",testIdPrefix:"face"};const i=C.bind({});i.args={title:"Secondary theme",theme:"secondary",testIdPrefix:"face"};var S,N,F;c.parameters={...c.parameters,docs:{...(S=c.parameters)==null?void 0:S.docs,source:{originalSource:"() => <FaceRecognition />",...(F=(N=c.parameters)==null?void 0:N.docs)==null?void 0:F.source}}};var w,_,v;i.parameters={...i.parameters,docs:{...(w=i.parameters)==null?void 0:w.docs,source:{originalSource:"() => <FaceRecognition />",...(v=(_=i.parameters)==null?void 0:_.docs)==null?void 0:v.source}}};const Q=["FaceTest","FaceSecondary"];export{i as FaceSecondary,c as FaceTest,Q as __namedExportsOrder,K as default};
